<!DOCTYPE html>
<html lang="uk" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Автоматизація ПРРО для Google Sheets: Checkbox/Вчасно.Каса</title>
    <meta name="description" content="Забудьте про ручне вибивання чеків. Налаштуємо автоматичну фіскалізацію продажів прямо з вашої Google-Таблиці за 6 днів. Надійний захист від штрафів ДПС.">
    <meta name="keywords" content="автоматизація прро, checkbox google sheets, вчасно каса інтеграція, автоматична фіскалізація, штрафи за прро 2024, чеки з гугл таблиць">
    <link rel="canonical" href="https://vchasno-ppo.com.ua/"> <!-- Замініть на ваш домен -->

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T1NVVS2E0H"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T1NVVS2E0H');
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Toastify JS CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
    <!-- Google reCAPTCHA -->
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <!-- Schema.org for Service -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Service",
      "name": "VCHASNO: PPO-Sheet - Автоматична фіскалізація для Google Sheets",
      "description": "Налаштування автоматичної фіскалізації продажів з Google-Таблиці через ПРРО Checkbox або Вчасно.Каса. Надійний захист від штрафів ДПС.",
      "provider": {
        "@type": "Organization",
        "name": "VCHASNO"
      },
      "areaServed": {
        "@type": "Country",
        "name": "UA"
      },
      "serviceType": "Автоматизація бізнес-процесів",
      "offers": {
        "@type": "Offer",
        "priceCurrency": "UAH",
        "price": "За запитом"
      }
    }
    </script>

    <style>
        /* Custom styles for form validation */
        input:required:invalid, select:required:invalid {
            border-color: #ef4444; /* red-500 */
        }
        input:required:invalid:focus, select:required:invalid:focus {
            outline-color: #ef4444;
            box-shadow: 0 0 0 2px #fecaca;
        }
    </style>
</head>
<body class="bg-white text-gray-800 font-sans antialiased">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex flex-col">
                <a href="#" class="text-2xl font-bold text-gray-900">VCHASNO</a>
                <p class="text-xs text-gray-500 -mt-1">Вчасно розпочати — вчасно масштабувати</p>
            </div>
            <a href="#form-section" class="hidden sm:inline-block bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700 transition-colors duration-300">
                Розрахувати вартість
            </a>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="hero" class="bg-gray-50 py-16 md:py-24">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 leading-tight">
                    Досі вибиваєте чеки вручну? <br class="hidden md:block"> Автоматизуйте ПРРО у вашій Google-Таблиці та уникніть штрафів до <span class="text-green-600">150%</span>
                </h1>
                <p class="mt-6 text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">
                    За 6 днів ваша таблиця сама буде створювати фіскальні чеки в Checkbox або Вчасно.Каса з кожного нового продажу. Економте 30+ годин на місяць і на 100% захистіть себе від помилок та штрафів ДПС.
                </p>
                <div class="mt-8 flex flex-col sm:flex-row justify-center items-center gap-4">
                    <a href="#form-section" class="w-full sm:w-auto bg-green-600 text-white font-bold text-lg py-4 px-8 rounded-lg hover:bg-green-700 transition-colors duration-300">
                        Розрахувати вартість для мого магазину
                    </a>
                </div>
                <p class="mt-4 text-sm text-gray-500">Разова оплата. Без абонплат. Дешевше за один середній штраф.</p>
            </div>
        </section>

        <!-- Problem Section -->
        <section id="problem" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900">Що ви втрачаєте щодня, відкладаючи автоматизацію?</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">Ручна фіскалізація — це не просто незручно. Це прямі ризики для вашого прибутку.</p>
                </div>
                <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Pain Point 1: Fines -->
                    <div class="bg-gray-50 p-8 rounded-xl border border-gray-200">
                        <div class="flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-6">
                            <i class="fa-solid fa-gavel text-2xl text-red-600"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900">Ризик штрафу 100-150%</h3>
                        <p class="mt-2 text-gray-600">Кожен пропущений або помилковий чек — це потенційний штраф, що може з'їсти ваш тижневий або навіть місячний прибуток.</p>
                    </div>
                    <!-- Pain Point 2: Wasted Time -->
                    <div class="bg-gray-50 p-8 rounded-xl border border-gray-200">
                        <div class="flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 mb-6">
                            <i class="fa-solid fa-hourglass-half text-2xl text-yellow-600"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900">30+ годин вашого часу</h3>
                        <p class="mt-2 text-gray-600">Щомісяця ви витрачаєте десятки годин на монотонне копіювання даних замість того, щоб шукати нових клієнтів та розвивати бізнес.</p>
                    </div>
                    <!-- Pain Point 3: Human Factor -->
                    <div class="bg-gray-50 p-8 rounded-xl border border-gray-200">
                        <div class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 mb-6">
                           <i class="fa-solid fa-circle-exclamation text-2xl text-blue-600"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900">Неминучі помилки</h3>
                        <p class="mt-2 text-gray-600">Неправильна сума, помилка в назві товару, пропущене замовлення — людський фактор, який коштує грошей та нервів.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Solution Section -->
        <section id="solution" class="bg-gray-50 py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="grid lg:grid-cols-2 gap-12 items-center">
                    <div class="flex justify-center">
                        <img src="https://placehold.co/600x400/e0f2fe/0891b2?text=Ваша+Google+Таблиця%0A%2B%0AНаш+Скрипт%0A%3D%0AАвтоматичні+Чеки" alt="Схема автоматизації ПРРО з Google Sheets" class="rounded-xl shadow-lg object-cover max-w-full">
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-900">Готове рішення за 6 днів: ваша таблиця сама створює чеки</h2>
                        <p class="mt-6 text-lg text-gray-600">Ми не створюємо нову програму, яку треба вивчати. Ми додаємо "суперсилу" до вашої звичної Google-Таблиці, підключаючи її напряму до Checkbox або Вчасно.Каса.</p>
                        <ul class="mt-8 space-y-4">
                            <li class="flex items-start">
                                <i class="fa-solid fa-check-circle text-green-500 mt-1 mr-3"></i>
                                <span><strong class="text-gray-900">Повна автоматизація:</strong> Додали новий рядок з продажем — чек автоматично створився в ПРРО. Без жодних кліків.</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check-circle text-green-500 mt-1 mr-3"></i>
                                <span><strong class="text-gray-900">Зручне керування:</strong> Спеціальне меню у вашій таблиці для додаткових дій: "Створити чек вручну" або "Надіслати повторно".</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check-circle text-green-500 mt-1 mr-3"></i>
                                <span><strong class="text-gray-900">Сервіс для клієнтів:</strong> Система автоматично надсилає фіскальний чек покупцю на Email, в Telegram або Viber.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Benefits (Quick Wins) Section -->
        <section id="benefits" class="py-16 md:py-24">
            <div class="container mx-auto px-6 text-center">
                 <h2 class="text-3xl md:text-4xl font-bold text-gray-900">Що зміниться у вашому бізнесі вже за перший тиждень?</h2>
                 <p class="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">Відчуйте результат ще до повної здачі проєкту.</p>
                 <div class="mt-12 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 text-left">
                     <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <p class="text-green-600 font-bold">За 2 дні</p>
                        <p class="mt-2 text-gray-700">Ваш акаунт ПРРО буде підключений до тестової копії вашої таблиці для перевірки з'єднання.</p>
                     </div>
                     <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <p class="text-green-600 font-bold">За 4 дні</p>
                        <p class="mt-2 text-gray-700">Ви зможете створити перший автоматичний фіскальний чек одним кліком прямо з таблиці.</p>
                     </div>
                     <div class="bg-white p-6 rounded-lg border border-gray-200 sm:col-span-2 lg:col-span-1">
                        <p class="text-green-600 font-bold">За 6 днів</p>
                        <p class="mt-2 text-gray-700">100% ваших продажів фіскалізуються автоматично. Ви більше не витрачаєте на це ні хвилини.</p>
                     </div>
                 </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section id="pricing" class="bg-gray-50 py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900">Ціна спокою: скільки коштує захист від штрафів?</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">Порівняйте разову інвестицію в автоматизацію з щоденними ризиками та витратами.</p>
                </div>
                
                <div class="mt-16 max-w-4xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8 items-stretch">
                    <!-- Option 1: Manual Work -->
                    <div class="p-8 bg-white rounded-xl border-2 border-dashed border-red-400">
                        <h3 class="text-2xl font-bold text-gray-800 text-center">Ручна робота (Зараз)</h3>
                        <ul class="mt-6 space-y-4 text-gray-600">
                            <li class="flex items-start">
                                <i class="fa-solid fa-circle-xmark text-red-500 text-xl mr-4 mt-1"></i>
                                <div><strong class="text-gray-900">Втрата ~7000 грн/міс</strong><br>30 годин вашого часу, який міг би приносити прибуток.</div>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-circle-xmark text-red-500 text-xl mr-4 mt-1"></i>
                                <div><strong class="text-gray-900">Ризик штрафу від 5000 грн</strong><br>За кожен невиданий чек. Перевірки посилюються.</div>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-circle-xmark text-red-500 text-xl mr-4 mt-1"></i>
                                <div><strong class="text-gray-900">Постійний стрес</strong><br>Страх помилитися чи щось пропустити, особливо при зростанні замовлень.</div>
                            </li>
                        </ul>
                    </div>
                    <!-- Option 2: Our Solution (Highlighted) -->
                    <div class="p-8 bg-green-600 text-white rounded-xl shadow-2xl">
                         <h3 class="text-2xl font-bold text-center">Автоматизація PPO-Sheet</h3>
                        <ul class="mt-6 space-y-4">
                            <li class="flex items-start">
                                <i class="fa-solid fa-circle-check text-white text-xl mr-4 mt-1"></i>
                                <div><strong class="text-white">Інвестиція 42-58 тис. грн</strong><br>Разово. Окупається за 2-3 місяці лише на економії часу.</div>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-circle-check text-white text-xl mr-4 mt-1"></i>
                                <div><strong class="text-white">Нульовий ризик штрафу</strong><br>Система не може забути чи пропустити чек. 100% фіскалізація.</div>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-circle-check text-white text-xl mr-4 mt-1"></i>
                                <div><strong class="text-white">Повний спокій</strong><br>Зосередьтесь на продажах, а не на рутині. Система працює за вас 24/7.</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section id="how-it-works" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900">Процес впровадження: 5 кроків до автоматизації</h2>
                </div>
                <div class="mt-16 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8">
                    <!-- Step 1 -->
                    <div class="relative p-6 bg-gray-50 rounded-lg">
                        <h3 class="text-lg font-bold text-green-700">1. Дзвінок-аудит (15 хв)</h3>
                        <p class="mt-2 text-sm text-gray-600">Ви показуєте вашу таблицю, ми фіксуємо вартість.</p>
                    </div>
                    <!-- Step 2 -->
                    <div class="relative p-6 bg-gray-50 rounded-lg">
                        <h3 class="text-lg font-bold text-green-700">2. Договір та доступи</h3>
                        <p class="mt-2 text-sm text-gray-600">Підписуємо договір, ви передаєте API-ключі від ПРРО.</p>
                    </div>
                    <!-- Step 3 -->
                    <div class="relative p-6 bg-gray-50 rounded-lg">
                        <h3 class="text-lg font-bold text-green-700">3. Розробка (3-4 дні)</h3>
                        <p class="mt-2 text-sm text-gray-600">Інтегруємо скрипт в копію вашої таблиці, тестуємо.</p>
                    </div>
                    <!-- Step 4 -->
                    <div class="relative p-6 bg-gray-50 rounded-lg">
                        <h3 class="text-lg font-bold text-green-700">4. Впровадження (30 хв)</h3>
                        <p class="mt-2 text-sm text-gray-600">Переносимо рішення на основну таблицю, навчаємо вас.</p>
                    </div>
                    <!-- Step 5 -->
                    <div class="relative p-6 bg-gray-50 rounded-lg">
                        <h3 class="text-lg font-bold text-green-700">5. Підтримка</h3>
                        <p class="mt-2 text-sm text-gray-600">14 днів безкоштовно виправляємо помилки та консультуємо.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Form Section -->
        <section id="form-section" class="py-16 md:py-24 bg-gray-800 text-white">
            <div class="container mx-auto px-6">
                <div class="grid lg:grid-cols-2 gap-12 items-center">
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold">Ваш наступний пропущений чек може коштувати 10 000 грн.</h2>
                        <p class="mt-4 text-lg text-gray-300">
                           Чи варта ручна робота такого ризику? Залиште заявку та отримайте безкоштовний розрахунок вартості автоматизації для вашого бізнесу протягом робочого дня.
                        </p>
                        <ul class="mt-8 space-y-4 text-gray-300">
                            <li class="flex items-center"><i class="fa-solid fa-check text-green-400 mr-3"></i> Працюємо за договором ФОП</li>
                            <li class="flex items-center"><i class="fa-solid fa-check text-green-400 mr-3"></i> Оплата по факту демонстрації прототипу</li>
                            <li class="flex items-center"><i class="fa-solid fa-check text-green-400 mr-3"></i> 14 днів безкоштовної підтримки</li>
                        </ul>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg text-gray-800">
                        <h3 class="text-2xl font-bold mb-6">Заявка на розрахунок вартості</h3>
                        <form id="leadForm" novalidate>
                            <input type="hidden" name="pageid" id="pageidInput">
                            <input type="hidden" name="source_info" value="avtomatyzatsiya_prro_google_sheets">

                            <div class="space-y-4">
                                <div>
                                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Ім'я*</label>
                                    <input type="text" id="name" name="name" required placeholder="Ваше ім'я" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition">
                                </div>
                                <div>
                                    <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Телефон*</label>
                                    <input type="tel" id="phone" name="phone" required placeholder="+38 (0XX) XXX-XX-XX" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition">
                                </div>
                                <div>
                                    <label for="service" class="block text-sm font-medium text-gray-700 mb-1">Середня кількість продажів на день*</label>
                                    <select id="service" name="service" required class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition bg-white">
                                        <option value="">Оберіть кількість</option>
                                        <option value="до 10">до 10</option>
                                        <option value="10-20">10-20</option>
                                        <option value="20-50">20-50</option>
                                        <option value="50+">50+</option>
                                    </select>
                                </div>
                                <input type="hidden" name="email" value="no-email@required.com">
                                <input type="hidden" name="telegram" value="">
                                <input type="hidden" name="company" value="">
                                <input type="hidden" name="website" value="">
                                <input type="hidden" name="budget" value="auto">
                                <input type="hidden" name="task" value="auto-prro-request">
                            </div>

                            <div class="mt-6">
                                <div class="g-recaptcha" data-sitekey="6LfMjDYsAAAAAJmEyqg5PKj6RqinCp3b76-PGw0Z"></div>
                            </div>
                            
                            <div class="mt-6">
                                <button type="submit" class="w-full bg-green-600 text-white font-bold text-lg py-3 px-6 rounded-lg hover:bg-green-700 transition-colors duration-300 disabled:bg-green-300">
                                    Отримати розрахунок
                                </button>
                            </div>
                            <p class="text-xs text-gray-500 mt-4 text-center">Натискаючи кнопку, ви погоджуєтеся з нашою <a href="pp.html" class="underline hover:text-green-600">Політикою Конфіденційності</a>.</p>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq" class="py-16 md:py-24">
            <div class="container mx-auto px-6 max-w-3xl">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 text-center">Часті питання</h2>
                <div class="mt-12 space-y-4">
                    <details class="group bg-gray-50 p-6 rounded-lg border border-gray-200">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer text-gray-900">
                            Чи безпечно передавати вам API-ключі від ПРРО?
                            <i class="fa-solid fa-chevron-down transition-transform duration-300 group-open:rotate-180"></i>
                        </summary>
                        <p class="text-gray-600 mt-4">Так, це безпечно. По-перше, ви генеруєте ключі самостійно у своєму кабінеті і можете їх відкликати в будь-який момент. По-друге, ми не отримуємо доступу до вашого кабінету ПРРО, а лише до API, що дозволяє створювати чеки. По-третє, всі ключі після налаштування зберігаються у властивостях вашого Google-скрипту, до якого маєте доступ тільки ви.</p>
                    </details>
                    <details class="group bg-gray-50 p-6 rounded-lg border border-gray-200">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer text-gray-900">
                            Що станеться, якщо сервіс ПРРО (Checkbox) не працюватиме?
                            <i class="fa-solid fa-chevron-down transition-transform duration-300 group-open:rotate-180"></i>
                        </summary>
                        <p class="text-gray-600 mt-4">Наш скрипт має систему обробки помилок. Якщо API ПРРО недоступне, скрипт не видалить дані, а позначить рядок як "не фіскалізовано" і спробує надіслати дані повторно через деякий час. Також ви отримаєте сповіщення про проблему.</p>
                    </details>
                    <details class="group bg-gray-50 p-6 rounded-lg border border-gray-200">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer text-gray-900">
                            Моя таблиця має складну структуру. Чи підійде ваше рішення?
                            <i class="fa-solid fa-chevron-down transition-transform duration-300 group-open:rotate-180"></i>
                        </summary>
                        <p class="text-gray-600 mt-4">90% нашого рішення є стандартним, але 10% — це завжди адаптація під структуру таблиці клієнта. На першому дзвінку-аудиті ми вивчимо вашу таблицю і точно скажемо, як ми адаптуємо скрипт. Базова вартість включає адаптацію під більшість стандартних структур обліку продажів.</p>
                    </details>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-8">
        <div class="container mx-auto px-6 text-center sm:flex sm:justify-between">
            <p class="text-sm">&copy; 2024 VCHASNO. Всі права захищено.</p>
            <div class="mt-4 sm:mt-0 space-x-6 text-sm">
                <a href="pp.html" class="hover:text-white transition-colors">Політика Конфіденційності</a>
                <a href="rules.html" class="hover:text-white transition-colors">Умови Надання Послуг</a>
            </div>
        </div>
    </footer>

    <!-- Toastify JS -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    
    <!-- Custom JS for Form Handling -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const pageidInput = document.getElementById('pageidInput');
            if (pageidInput) {
                try {
                    pageidInput.value = crypto.randomUUID();
                } catch (e) {
                    pageidInput.value = ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
                        (c ^ (crypto.getRandomValues(new Uint8Array(1))[0] & 15) >> c / 4).toString(16)
                    );
                }
            }
            
            const phoneInput = document.getElementById('phone');
            if (phoneInput) {
                phoneInput.addEventListener('input', (e) => {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.startsWith('380') && value.length > 2) { value = value.substring(2); }
                    if (value.length > 9) { value = value.substring(0, 9); }
                    let formattedValue = '+38 (0';
                    if (value.length > 0) { formattedValue += value.substring(0, 2); }
                    if (value.length > 2) { formattedValue += ') ' + value.substring(2, 5); }
                    if (value.length > 5) { formattedValue += '-' + value.substring(5, 7); }
                    if (value.length > 7) { formattedValue += '-' + value.substring(7, 9); }
                    e.target.value = formattedValue.substring(0, 19);
                });
            }

            const form = document.getElementById('leadForm');
            if(form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const captchaResponse = grecaptcha.getResponse();
                    if (!captchaResponse) {
                        showToast('error', 'Будь ласка, пройдіть капчу');
                        return;
                    }

                    const btn = this.querySelector('button[type="submit"]');
                    const originalText = btn.innerHTML;
                    btn.disabled = true;
                    btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> ВІДПРАВЛЯЄМО...';

                    const formData = new FormData(this);
                    
                    const rawPhone = (formData.get('phone') || '').replace(/\D/g, '');
                     if (rawPhone.length < 9) {
                         showToast('error', 'Будь ласка, введіть коректний номер телефону.');
                         btn.disabled = false;
                         btn.innerHTML = originalText;
                         return;
                    }
                    formData.set('phone', '380' + rawPhone.slice(-9));
                    
                    const params = new URLSearchParams(formData);
                    if (!params.has('g-recaptcha-response')) {
                        params.append('g-recaptcha-response', captchaResponse);
                    }
                    const scriptURL = "https://script.google.com/macros/s/AKfycbzY9v3k4_Ie6lqCIHfHMeJTke_OYmIcV47tnKwB2KVNqw4TwBvs18erHoa58a5GJ31g/exec";

                    fetch(`${scriptURL}?${params.toString()}`, { method: 'GET', mode: 'cors' })
                    .then(response => response.ok ? response.json() : Promise.reject(new Error(`HTTP error! status: ${response.status}`)))
                    .then(data => {
                        if (data && (data.status === 200 || (data.result && data.result.includes('Success')))) {
                            showToast('success', 'Дякуємо! Заявка отримана.');
                            if (typeof window.dataLayer !== 'undefined') {
                                window.dataLayer.push({'event': 'form_submission_success', 'form_type': 'lead'});
                            }
                            this.reset();
                            grecaptcha.reset(); 
                        } else {
                            showToast('error', 'Помилка: ' + (data.result || 'Невідома помилка'));
                        }
                    })
                    .catch(err => {
                        console.error('Fetch error:', err);
                        showToast('error', 'Сталася помилка при відправці. Спробуйте пізніше.');
                    })
                    .finally(() => {
                        btn.disabled = false;
                        btn.innerHTML = originalText;
                    });
                });
            }
        });

        function showToast(type, message) {
            Toastify({
                text: message, duration: 5000, close: true, gravity: "top", position: "right", stopOnFocus: true,
                style: { background: type === 'success' ? "linear-gradient(to right, #00b09b, #96c93d)" : "linear-gradient(to right, #ff5f6d, #ffc371)", }
            }).showToast();
        }
    </script>
</body>
</html>