<!DOCTYPE html>
<html lang="uk" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Supplier-Sync: Автоматизація оновлення цін та залишків від постачальників</title>
    <meta name="description" content="Збирайте ціни та залишки від усіх постачальників в одну таблицю автоматично. Синхронізація з поштою, аналіз змін 24/7. Захистіть свій бізнес від збитків.">
    <meta name="keywords" content="автоматичне оновлення залишків, парсинг прайсів excel, зведення прайсів постачальників, автоматизація дропшипінг, моніторинг цін постачальників">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T1NVVS2E0H"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T1NVVS2E0H');
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Toastify JS CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
    <!-- Google reCAPTCHA -->
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Service",
      "name": "VCHASNO: Supplier-Sync",
      "description": "Автоматичний парсинг прайсів та моніторинг залишків постачальників через Google Apps Script та Python. Інтеграція з Gmail.",
      "areaServed": "UA",
      "provider": {
        "@type": "Organization",
        "name": "VCHASNO"
      },
      "offers": {
        "@type": "Offer",
        "price": "За запиту",
        "priceCurrency": "UAH"
      }
    }
    </script>

    <style>
        .data-bg { background-image: radial-gradient(circle at 2px 2px, rgba(255,255,255,0.05) 1px, transparent 0); background-size: 32px 32px; }
        .accent-glow { box-shadow: 0 0 20px rgba(16, 185, 129, 0.2); }
        input:invalid:not(:placeholder-shown), select:invalid:not(:placeholder-shown) { border-color: #ef4444; }
        .process-grid-item { position: relative; overflow: hidden; }
        .g-recaptcha { transform: scale(0.9); transform-origin: 0 0; }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 font-sans antialiased data-bg">

    <!-- Header -->
    <header class="bg-slate-900/80 backdrop-blur-md sticky top-0 z-50 border-b border-white/5">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex flex-col">
                <div class="text-2xl font-black tracking-tighter text-white uppercase">VCHASNO</div>
                <div class="text-[10px] uppercase tracking-widest text-emerald-500 font-bold leading-none">Вчасно розпочати — вчасно масштабувати</div>
            </div>
            <a href="#form-section" class="bg-emerald-600 text-white px-5 py-2.5 rounded shadow-lg font-bold text-sm hover:bg-emerald-700 transition">
                Замовити аудит
            </a>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="relative pt-20 pb-32 overflow-hidden border-b border-white/5">
            <div class="container mx-auto px-6 relative z-10">
                <div class="max-w-4xl">
                    <div class="inline-flex items-center gap-2 bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 px-3 py-1 rounded text-xs font-bold mb-8 uppercase tracking-widest">
                        <i class="fa-solid fa-code-branch"></i> Авто-парсинг 24/7
                    </div>
                    <h1 class="text-4xl md:text-6xl font-black leading-[1.1] mb-8 tracking-tight">
                        Перестаньте продавати в мінус: <br>
                        <span class="text-emerald-500">Автоматичний збір прайсів</span> від усіх постачальників
                    </h1>
                    <p class="text-lg md:text-xl text-slate-400 mb-10 max-w-2xl leading-relaxed">
                        Поки ви спите — Supplier-Sync перевіряє вашу пошту, знаходить нові Excel-файли та оновлює ціни і залишки у вашій Master-таблиці.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <a href="#form-section" class="bg-emerald-600 text-white px-8 py-4 rounded font-bold text-lg hover:bg-emerald-700 transition shadow-xl accent-glow text-center">
                            Дізнатись вартість для мого бізнесу
                        </a>
                        <div class="flex items-center gap-4 px-6 py-4 bg-slate-900 border border-white/10 rounded backdrop-blur-sm">
                            <i class="fa-solid fa-clock-rotate-left text-2xl text-blue-400"></i>
                            <span class="text-sm font-medium text-slate-300 tracking-tight">Економія 6 годин щодня</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Background Visual Decoration -->
            <div class="absolute -right-20 top-1/2 -translate-y-1/2 opacity-10 pointer-events-none hidden lg:block">
                <i class="fa-solid fa-database text-[40rem] text-emerald-500"></i>
            </div>
        </section>

        <!-- Problem Section -->
        <section id="problem" class="py-24 bg-slate-900/50">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-black mb-4 uppercase">Чому ручне зведення прайсів — це збитки?</h2>
                    <p class="text-slate-400 text-lg">Хаос у залишках та цінах коштує вам значно більше, ніж автоматизація.</p>
                </div>
                <div class="grid md:grid-cols-3 gap-10">
                    <div class="p-8 bg-slate-950/50 border border-white/5 rounded-2xl group hover:border-red-500/30 transition">
                        <div class="w-14 h-14 bg-red-500/10 text-red-500 rounded flex items-center justify-center mb-6 text-2xl">
                            <i class="fa-solid fa-chart-line-down"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4">Продажі у мінус</h3>
                        <p class="text-slate-400 text-sm leading-relaxed">Постачальник змінив ціну о 9:00, а ви дізналися про це о 16:00, вже продавши партію товару за старою ціною.</p>
                    </div>
                    <div class="p-8 bg-slate-950/50 border border-white/5 rounded-2xl group hover:border-yellow-500/30 transition">
                        <div class="w-14 h-14 bg-yellow-500/10 text-yellow-500 rounded flex items-center justify-center mb-6 text-2xl">
                            <i class="fa-solid fa-ban"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4">Штрафи маркетплейсів</h3>
                        <p class="text-slate-400 text-sm leading-relaxed">Товар закінчився у постачальника, а ви прийняли замовлення. Результат — зниження рейтингу на Prom/Rozetka та штраф.</p>
                    </div>
                    <div class="p-8 bg-slate-950/50 border border-white/5 rounded-2xl group hover:border-blue-500/30 transition">
                        <div class="w-14 h-14 bg-blue-500/10 text-blue-500 rounded flex items-center justify-center mb-6 text-2xl">
                            <i class="fa-solid fa-user-clock"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4">Операційний тупик</h3>
                        <p class="text-slate-400 text-sm leading-relaxed">Менеджер витрачає 70% часу на "мавпячу роботу" — копіпаст з Excel замість роботи з клієнтами та пошуку нових ніш.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Solution Flow flowchart -->
        <section id="solution" class="py-24 bg-slate-950 border-y border-white/5">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-black mb-4 tracking-tight uppercase">Як працює Supplier-Sync</h2>
                    <p class="text-slate-400">Повний цикл автоматизації даних у вашій Google-Таблиці</p>
                </div>
                <div class="grid lg:grid-cols-5 gap-4 items-center">
                    <div class="p-6 bg-slate-900 border border-white/5 rounded-xl text-center">
                        <i class="fa-solid fa-envelope-open-text text-3xl text-emerald-500 mb-3"></i>
                        <div class="text-xs font-bold uppercase tracking-widest text-slate-300">Ваша пошта (Gmail)</div>
                    </div>
                    <div class="flex justify-center text-emerald-500"><i class="fa-solid fa-arrow-right lg:rotate-0 rotate-90"></i></div>
                    <div class="p-6 bg-emerald-600 rounded-xl text-center shadow-xl shadow-emerald-900/20">
                        <i class="fa-solid fa-microchip text-3xl text-white mb-3"></i>
                        <div class="text-xs font-bold uppercase tracking-widest text-white italic">Auto-Parser Script</div>
                    </div>
                    <div class="flex justify-center text-emerald-500"><i class="fa-solid fa-arrow-right lg:rotate-0 rotate-90"></i></div>
                    <div class="p-6 bg-slate-900 border border-white/5 rounded-xl text-center">
                        <i class="fa-solid fa-table-list text-3xl text-blue-500 mb-3"></i>
                        <div class="text-xs font-bold uppercase tracking-widest text-slate-300">Master-Таблиця</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Process Section -->
        <section id="process" class="py-24 bg-slate-950">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-black mb-4 uppercase tracking-tight italic">Ваш результат за 6 днів</h2>
                    <p class="text-slate-500">Впровадження системи крок за кроком</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Step 1 -->
                    <div class="process-grid-item p-8 bg-slate-900/30 border border-white/5 rounded-2xl">
                        <div class="text-8xl font-black text-white/5 absolute -top-4 -left-4 z-0">1</div>
                        <div class="relative z-10">
                            <h4 class="font-bold text-xl mb-3 text-emerald-500">Аудит прайсів</h4>
                            <p class="text-slate-400 text-sm">Вивчаємо формати ваших 5-10 постачальників та фіксуємо логіку зіставлення товарів.</p>
                        </div>
                    </div>
                    <!-- Step 2 -->
                    <div class="process-grid-item p-8 bg-slate-900/30 border border-white/5 rounded-2xl">
                        <div class="text-8xl font-black text-white/5 absolute -top-4 -left-4 z-0">2</div>
                        <div class="relative z-10">
                            <h4 class="font-bold text-xl mb-3 text-emerald-500">Налаштування</h4>
                            <p class="text-slate-400 text-sm">Пишемо скрипти-парсери під кожен окремий формат (XLSX, XML, CSV).</p>
                        </div>
                    </div>
                    <!-- Step 3 -->
                    <div class="process-grid-item p-8 bg-slate-900/30 border border-white/5 rounded-2xl">
                        <div class="text-8xl font-black text-white/5 absolute -top-4 -left-4 z-0">3</div>
                        <div class="relative z-10">
                            <h4 class="font-bold text-xl mb-3 text-emerald-500">Інтеграція</h4>
                            <p class="text-slate-400 text-sm">Підключаємо автоматичний збір файлів з вашої пошти прямо в Master-таблицю.</p>
                        </div>
                    </div>
                    <!-- Step 4 -->
                    <div class="process-grid-item p-8 bg-emerald-600 rounded-2xl shadow-2xl">
                        <div class="text-8xl font-black text-white/10 absolute -top-4 -left-4 z-0">4</div>
                        <div class="relative z-10 pt-4">
                            <h4 class="font-bold text-xl mb-3 text-white uppercase italic">Запуск!</h4>
                            <p class="text-emerald-50 text-sm">Тестуємо систему в реальному часі, навчаємо вас керувати маржою та здаємо проект.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section id="pricing" class="py-24 bg-slate-900/30 border-y border-white/5">
            <div class="container mx-auto px-6">
                <div class="max-w-5xl mx-auto grid lg:grid-cols-2 gap-16 items-center">
                    <div>
                        <h2 class="text-3xl md:text-4xl font-black mb-8 leading-tight">Вартість автоматизації vs Витрати</h2>
                        <div class="space-y-6">
                            <div class="flex items-center gap-4 border-l-4 border-red-600 pl-6 py-2 bg-red-600/5">
                                <div>
                                    <div class="text-xs font-bold text-red-500 uppercase">Менеджер (закупівлі)</div>
                                    <div class="text-3xl font-black text-white">від 15 000 грн/міс</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-4 border-l-4 border-emerald-600 pl-6 py-2 bg-emerald-600/5">
                                <div>
                                    <div class="text-xs font-bold text-emerald-500 uppercase">Supplier-Sync</div>
                                    <div class="text-3xl font-black text-white">від 32 000 грн (разово)</div>
                                </div>
                            </div>
                        </div>
                        <ul class="mt-10 space-y-4 text-sm text-slate-400">
                            <li class="flex items-center gap-3"><i class="fa-solid fa-circle-check text-emerald-500"></i> Жодних щомісячних платежів за скрипт</li>
                            <li class="flex items-center gap-3"><i class="fa-solid fa-circle-check text-emerald-500"></i> Офіційний договір ФОП + NDA</li>
                            <li class="flex items-center gap-3"><i class="fa-solid fa-circle-check text-emerald-500"></i> 14 днів безкоштовної техпідтримки</li>
                        </ul>
                    </div>
                    <div class="bg-white rounded-3xl p-10 text-slate-900 shadow-2xl relative overflow-hidden">
                        <h3 class="text-2xl font-black mb-8">Розрахувати ROI</h3>
                        <div class="space-y-6 mb-8">
                            <div class="p-6 bg-slate-50 rounded-2xl border border-slate-200">
                                <div class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Вивільнений час</div>
                                <div class="text-3xl font-black text-emerald-600">80 годин / міс</div>
                                <div class="text-xs text-slate-500 mt-2 font-medium italic">Для розвитку вашого e-commerce</div>
                            </div>
                        </div>
                        <a href="#form-section" class="block w-full bg-emerald-600 text-white text-center py-4 rounded-xl font-bold hover:bg-emerald-700 transition shadow-lg accent-glow">Отримати персональну пропозицію</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Form Section -->
        <section id="form-section" class="py-24 relative overflow-hidden">
            <div class="container mx-auto px-6">
                <div class="max-w-5xl mx-auto flex flex-col lg:flex-row bg-slate-900 rounded-[2.5rem] shadow-2xl overflow-hidden border border-white/10">
                    <div class="lg:w-2/5 p-12 lg:p-16 bg-emerald-600 text-white flex flex-col justify-between relative overflow-hidden">
                        <div>
                            <h2 class="text-3xl font-black mb-8 leading-tight italic uppercase tracking-tighter">Ваш постачальник щойно оновив прайс...</h2>
                            <p class="text-emerald-50 mb-10 leading-relaxed text-lg tracking-tight">Скільки часу та грошей ви втратите, поки оновите свої ціни вручну? Зробіть це за 2 хвилини.</p>
                        </div>
                        <div class="space-y-4 relative z-10">
                            <div class="flex items-center gap-4 text-xs font-bold uppercase tracking-widest">
                                <i class="fa-solid fa-shield-halved text-xl"></i> Дані захищено (NDA)
                            </div>
                            <div class="flex items-center gap-4 text-xs font-bold uppercase tracking-widest">
                                <i class="fa-solid fa-code text-xl"></i> Скрипт залишається у вас
                            </div>
                        </div>
                        <i class="fa-solid fa-bolt absolute -right-10 -bottom-10 text-[15rem] text-white/10 pointer-events-none"></i>
                    </div>
                    <div class="lg:w-3/5 p-12 lg:p-16 bg-white">
                        <h3 class="text-2xl font-black mb-8 text-slate-900">Запит на аудит прайсів</h3>
                        <form id="leadForm" class="space-y-5 text-slate-900">
                            <input type="hidden" name="pageid" id="pageidInput">
                            <input type="hidden" name="source_info" value="supplier_sync_automation">

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                <div class="space-y-1">
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest ml-1">Контакти</label>
                                    <input type="text" name="name" required placeholder="Ім'я*" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm transition">
                                </div>
                                <div class="space-y-1">
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest opacity-0">Email</label>
                                    <input type="email" name="email" required placeholder="Email*" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm transition">
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                <input type="tel" name="phone" id="phoneInput" required placeholder="380XXXXXXXXX*" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm transition">
                                <input type="text" name="telegram" placeholder="Telegram / Viber" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm transition">
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5 pt-2 border-t border-slate-100">
                                <input type="text" name="company" placeholder="Назва компанії" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm transition">
                                <input type="url" name="website" placeholder="Сайт / Посилання на магазин" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm transition">
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                <select name="service" required class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm appearance-none cursor-pointer transition">
                                    <option value="">Кількість постачальників*</option>
                                    <option value="1-3">1-3 постачальники</option>
                                    <option value="4-10">4-10 постачальників</option>
                                    <option value="10+">Понад 10 постачальників</option>
                                </select>
                                <select name="budget" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm appearance-none cursor-pointer transition">
                                    <option value="">Орієнтовний бюджет</option>
                                    <option value="30-40k">30 000 - 40 000 грн</option>
                                    <option value="40-50k">40 000 - 50 000 грн</option>
                                    <option value="50k+">Понад 50 000 грн</option>
                                </select>
                            </div>

                            <textarea name="task" rows="3" placeholder="Яку кількість товарів ви обробляєте і в яких форматах прайси?" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-600 outline-none text-sm transition"></textarea>

                            <div class="pt-2">
                                <div class="g-recaptcha" data-sitekey="6LfMjDYsAAAAAJmEyqg5PKj6RqinCp3b76-PGw0Z"></div>
                            </div>

                            <button type="submit" class="w-full bg-emerald-600 text-white font-black py-4 rounded-xl hover:bg-emerald-700 transition-all uppercase tracking-widest text-sm shadow-xl accent-glow">
                                Замовити безкоштовний аудит
                            </button>
                            <p class="text-[9px] text-center text-slate-400 uppercase tracking-tight">Натискаючи на кнопку, ви погоджуєтесь з <a href="pp.html" class="underline">політикою конфіденційності</a></p>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="py-24 bg-slate-950/50">
            <div class="container mx-auto px-6 max-w-4xl">
                <h2 class="text-3xl font-black mb-12 text-center uppercase tracking-tight italic text-slate-500">Питання та відповіді</h2>
                <div class="space-y-4">
                    <details class="group bg-slate-900 border border-white/5 rounded-2xl p-6 cursor-pointer hover:border-emerald-500/30 transition">
                        <summary class="flex justify-between items-center font-bold list-none">
                            Ви отримаєте доступ до моєї пошти Gmail?
                            <i class="fa-solid fa-chevron-down group-open:rotate-180 transition text-emerald-500"></i>
                        </summary>
                        <p class="mt-4 text-slate-400 text-sm leading-relaxed">Скрипт працює всередині вашого Google-акаунта. Ви надаєте йому дозвіл лише на читання листів з певною міткою або від певних адрес. Ми не маємо доступу до вашої пошти, весь код залишається у вашій власності.</p>
                    </details>
                    <details class="group bg-slate-900 border border-white/5 rounded-2xl p-6 cursor-pointer hover:border-emerald-500/30 transition">
                        <summary class="flex justify-between items-center font-bold list-none">
                            Що буде, якщо постачальник змінить структуру файлу?
                            <i class="fa-solid fa-chevron-down group-open:rotate-180 transition text-emerald-500"></i>
                        </summary>
                        <p class="mt-4 text-slate-400 text-sm leading-relaxed">Система надішле вам сповіщення в Telegram, що дані не вдалося обробити. Після цього ми допоможемо швидко адаптувати парсер під нову структуру в межах підтримки (якщо зміни кардинальні) або ви самі зможете змінити назви колонок у налаштуваннях.</p>
                    </details>
                    <details class="group bg-slate-900 border border-white/5 rounded-2xl p-6 cursor-pointer hover:border-emerald-500/30 transition">
                        <summary class="flex justify-between items-center font-bold list-none">
                            Чи може система оновлювати ціни одразу на моєму сайті?
                            <i class="fa-solid fa-chevron-down group-open:rotate-180 transition text-emerald-500"></i>
                        </summary>
                        <p class="mt-4 text-slate-400 text-sm leading-relaxed">Так. На базі Master-таблиці ми можемо налаштувати генерацію XML-фіду (для Prom.ua, Rozetka, Horoshop) або пряму інтеграцію через API з вашим сайтом чи CRM. Це обговорюється окремо.</p>
                    </details>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 py-16 border-t border-white/5">
        <div class="container mx-auto px-6 text-center">
            <div class="flex flex-col items-center mb-10 text-white">
                <div class="text-3xl font-black tracking-tighter uppercase italic">VCHASNO</div>
                <div class="text-[10px] uppercase tracking-widest text-slate-500 font-bold">Вчасно розпочати — вчасно масштабувати</div>
            </div>
            <div class="flex justify-center gap-8 mb-10 text-xs font-bold uppercase tracking-widest text-slate-400">
                <a href="pp.html" class="hover:text-white transition">Політика Конфіденційності</a>
                <a href="rules.html" class="hover:text-white transition">Умови Надання Послуг</a>
            </div>
            <div class="text-[10px] text-slate-600 font-medium">
                &copy; 2026 VCHASNO. Професійна автоматизація обробки даних на базі Google Apps Script та Python.<br>
                Supplier-Sync є технічним інструментом і не несе відповідальності за стратегію ціноутворення клієнта.
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 1. UUID generation
            const pageidInput = document.getElementById('pageidInput');
            if (pageidInput) {
                pageidInput.value = ([1e7]+-1e3+-4e3+-8e2+-1e11).replace(/[018]/g, c =>
                    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
                );
            }

            // 2. Phone mask (numeric cleaning)
            const phoneInput = document.getElementById('phoneInput');
            phoneInput.addEventListener('input', (e) => {
                let val = e.target.value.replace(/\D/g, '');
                if (val.length > 12) val = val.slice(0, 12);
                e.target.value = val;
            });

            // 3. Form Submission
            document.getElementById('leadForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const captchaResponse = grecaptcha.getResponse();
                if (!captchaResponse) {
                    showToast('error', 'Будь ласка, пройдіть капчу');
                    return;
                }

                const btn = this.querySelector('button[type="submit"]');
                const originalText = btn.innerText;
                btn.disabled = true;
                btn.innerText = 'ОБРОБЛЯЄМО...';

                const formData = new FormData(this);
                const rawPhone = formData.get('phone').replace(/\D/g, ''); 
                
                const params = new URLSearchParams(formData);
                params.set('phone', rawPhone);
                
                if (!params.has('g-recaptcha-response')) {
                    params.append('g-recaptcha-response', captchaResponse);
                }

                const scriptURL = "https://script.google.com/macros/s/AKfycbzjaOR3IlxQGtHYxz1EK2KOfYcVb_bdp4EPe5NKKG3LR4Uad3G9-2UdJjdrtuyS1962OA/exec";

                fetch(`${scriptURL}?${params.toString()}`, {
                    method: 'GET',
                    mode: 'cors'
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 200 || data.result.includes('Success')) {
                        showToast('success', 'Дякуємо! Аудит замовлено. Зв\'яжемось з вами скоро.');
                        window.dataLayer.push({'event': 'form_submission_success', 'form_type': 'lead'});
                        this.reset();
                        grecaptcha.reset(); 
                    } else {
                        showToast('error', 'Помилка: ' + (data.result || 'Спробуйте пізніше'));
                    }
                })
                .catch(err => {
                    console.error('Fetch error:', err);
                    showToast('error', 'Сталася помилка при відправці. Перевірте з\'єднання.');
                })
                .finally(() => {
                    btn.disabled = false;
                    btn.innerText = originalText;
                });
            });

            function showToast(type, message) {
                Toastify({
                    text: message,
                    duration: 5000,
                    gravity: "bottom",
                    position: "center",
                    style: {
                        background: type === 'success' ? "#10b981" : "#ef4444",
                        borderRadius: "12px",
                        boxShadow: "0 10px 15px -3px rgba(0,0,0,0.1)",
                        fontSize: "14px",
                        fontWeight: "600"
                    }
                }).showToast();
            }
        });
    </script>
</body>
</html>